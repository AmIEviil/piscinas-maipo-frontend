import React, { useState, useEffect } from "react";

interface EyeIconProps {
  color?: string;
  size?: number | string;
  className?: string;
  open?: boolean;
  onClick?: () => void;
  skipClick?: boolean;
  controlled?: boolean; // New prop to determine if it's controlled or not
}

const EyeIcon: React.FC<EyeIconProps> = ({
  color = "currentColor",
  size = 12,
  className = "",
  open = true,
  onClick,
  skipClick = false,
  controlled = false, // Default to uncontrolled (original behavior)
}) => {
  const [show, setShow] = useState(open);

  // Sync internal state with open prop only when controlled
  useEffect(() => {
    if (controlled) {
      setShow(open);
    }
  }, [open, controlled]);

  const currentShow = controlled ? open : show;

  if (currentShow) {
    return (
      <svg
        onClick={() => {
          if (skipClick) return;
          if (!controlled) setShow(false);
          onClick?.();
        }}
        width={size}
        height={size}
        viewBox="0 0 36 28"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        className={className}
      >
        <path
          d="M17.9969 3C13.9222 3 10.5725 4.85 8.00399 7.23125C5.59795 9.46875 3.9356 12.125 3.08567 14C3.9356 15.875 5.59795 18.5312 7.99774 20.7687C10.5725 23.15 13.9222 25 17.9969 25C22.0715 25 25.4212 23.15 27.9898 20.7687C30.3958 18.5312 32.0582 15.875 32.9081 14C32.0582 12.125 30.3958 9.46875 27.996 7.23125C25.4212 4.85 22.0715 3 17.9969 3ZM5.96042 5.0375C8.90391 2.3 12.9473 0 17.9969 0C23.0464 0 27.0898 2.3 30.0333 5.0375C32.9581 7.75625 34.9142 11 35.8453 13.2312C36.0516 13.725 36.0516 14.275 35.8453 14.7687C34.9142 17 32.9581 20.25 30.0333 22.9625C27.0898 25.7 23.0464 28 17.9969 28C12.9473 28 8.90391 25.7 5.96042 22.9625C3.03567 20.25 1.07959 17 0.154674 14.7687C-0.051558 14.275 -0.051558 13.725 0.154674 13.2312C1.07959 11 3.03567 7.75 5.96042 5.0375ZM17.9969 19C20.7591 19 22.9964 16.7625 22.9964 14C22.9964 11.2375 20.7591 9 17.9969 9C17.9531 9 17.9156 9 17.8719 9C17.9531 9.31875 17.9969 9.65625 17.9969 10C17.9969 12.2063 16.2033 14 13.9972 14C13.6535 14 13.316 13.9563 12.9973 13.875C12.9973 13.9188 12.9973 13.9563 12.9973 14C12.9973 16.7625 15.2346 19 17.9969 19ZM17.9969 6C20.1184 6 22.1531 6.84285 23.6532 8.34315C25.1534 9.84344 25.9962 11.8783 25.9962 14C25.9962 16.1217 25.1534 18.1566 23.6532 19.6569C22.1531 21.1571 20.1184 22 17.9969 22C15.8753 22 13.8407 21.1571 12.3405 19.6569C10.8404 18.1566 9.99757 16.1217 9.99757 14C9.99757 11.8783 10.8404 9.84344 12.3405 8.34315C13.8407 6.84285 15.8753 6 17.9969 6Z"
          fill={color}
        />
      </svg>
    );
  }
  return (
    <svg
      onClick={() => {
        if (skipClick) return;
        if (!controlled) setShow(true);
        onClick?.();
      }}
      width={size}
      height={size}
      viewBox="0 0 40 32"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      className={className}
    >
      <path
        d="M2.42531 0.319094C1.77532 -0.193394 0.831587 -0.074647 0.319096 0.575339C-0.193395 1.22532 -0.0746473 2.16905 0.575341 2.68154L37.5747 31.6809C38.2247 32.1934 39.1684 32.0746 39.6809 31.4247C40.1934 30.7747 40.0746 29.8309 39.4247 29.3185L32.8498 24.1686C35.3247 21.6311 36.9997 18.7874 37.8434 16.7687C38.0497 16.275 38.0497 15.725 37.8434 15.2313C36.9122 13.0001 34.956 9.75014 32.031 7.0377C29.0936 4.30026 25.0499 2.00031 20 2.00031C15.7376 2.00031 12.1876 3.64402 9.41893 5.80022L2.42531 0.319094ZM11.8626 7.71268C14.1251 6.10647 16.8438 5.00024 20 5.00024C24.0749 5.00024 27.4249 6.8502 29.9936 9.2314C32.3998 11.4688 34.0623 14.125 34.9122 16C34.1247 17.75 32.6248 20.1749 30.4811 22.3061L27.1186 19.6687C27.6874 18.5687 28.0061 17.325 28.0061 16C28.0061 11.5813 24.4249 8.00018 20.0063 8.00018C17.9938 8.00018 16.1501 8.74391 14.7438 9.96888L11.8626 7.71268ZM24.6812 17.7625L19.5875 13.7688C19.85 13.2376 20 12.6313 20 12.0001C20 11.6563 19.9562 11.3189 19.875 11.0001C19.9188 11.0001 19.9562 11.0001 20 11.0001C22.7625 11.0001 24.9999 13.2376 24.9999 16C24.9999 16.6187 24.8874 17.2125 24.6812 17.7625ZM25.2687 25.906C23.6749 26.5873 21.9187 26.9998 20 26.9998C15.9251 26.9998 12.5751 25.1498 10.0064 22.7686C7.60022 20.5311 5.93775 17.875 5.08776 16C5.6065 14.85 6.43149 13.4063 7.55022 11.9501L5.19401 10.0939C3.76904 11.9501 2.7503 13.8 2.15656 15.2313C1.95032 15.725 1.95032 16.275 2.15656 16.7687C3.0878 18.9999 5.04401 22.2499 7.96896 24.9623C10.9064 27.6997 14.9501 29.9997 20 29.9997C22.9874 29.9997 25.6187 29.1935 27.8874 27.9685L25.2687 25.906ZM12.0001 16C12.0001 20.4187 15.5813 23.9998 20 23.9998C20.8312 23.9998 21.6312 23.8748 22.3875 23.6373L18.875 20.8749C17.4063 20.5374 16.1813 19.5499 15.5188 18.2312L12.0126 15.4688C12.0001 15.6438 11.9939 15.8188 11.9939 16H12.0001Z"
        fill={color}
      />
    </svg>
  );
};

export default EyeIcon;
